<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Smart Dustbin Ecosystem - Admin Dashboard</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.3/font/bootstrap-icons.css">
    <link rel="stylesheet" href="css/style.css">
</head>
<body>
    <div class="container-fluid">
        <div class="row">
            <!-- Sidebar -->
            <nav id="sidebar" class="col-md-3 col-lg-2 d-md-block bg-dark sidebar collapse">
                <div class="position-sticky pt-3 sidebar-sticky">
                    <div class="text-center mb-4">
                        <img src="img/eco-logo.png" alt="Eco Rewards Logo" class="logo-img">
                        <h4 class="text-white mt-2">ECO REWARDS</h4>
                        <p class="text-muted">Admin Dashboard</p>
                    </div>
                    <ul class="nav flex-column">
                        <li class="nav-item">
                            <a class="nav-link active" href="#" data-page="dashboard">
                                <i class="bi bi-house-door me-2"></i>
                                Dashboard
                            </a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="#" data-page="bins">
                                <i class="bi bi-trash me-2"></i>
                                Smart Bins
                            </a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="#" data-page="users">
                                <i class="bi bi-people me-2"></i>
                                Users
                            </a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="#" data-page="rewards">
                                <i class="bi bi-gift me-2"></i>
                                Rewards
                            </a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="#" data-page="deposits">
                                <i class="bi bi-recycle me-2"></i>
                                Deposits
                            </a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="#" data-page="simulation">
                                <i class="bi bi-cpu me-2"></i>
                                Simulation
                            </a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="#" data-page="settings">
                                <i class="bi bi-gear me-2"></i>
                                Settings
                            </a>
                        </li>
                    </ul>
                    <hr class="my-3 bg-secondary">
                    <div class="px-3">
                        <button id="logoutBtn" class="btn btn-danger w-100">
                            <i class="bi bi-box-arrow-right me-2"></i>
                            Logout
                        </button>
                    </div>
                </div>
            </nav>

            <!-- Main content -->
            <main class="col-md-9 ms-sm-auto col-lg-10 px-md-4">
                <!-- Header -->
                <div class="d-flex justify-content-between flex-wrap flex-md-nowrap align-items-center pt-3 pb-2 mb-3 border-bottom">
                    <h1 class="h2" id="pageTitle">Dashboard</h1>
                    <div class="btn-toolbar mb-2 mb-md-0">
                        <div class="btn-group me-2">
                            <button id="refreshBtn" type="button" class="btn btn-sm btn-outline-primary">
                                <i class="bi bi-arrow-clockwise me-1"></i>
                                Refresh
                            </button>
                        </div>
                        <div class="dropdown">
                            <button class="btn btn-sm btn-outline-secondary dropdown-toggle" type="button" data-bs-toggle="dropdown">
                                <i class="bi bi-person-circle me-1"></i>
                                Admin
                            </button>
                            <ul class="dropdown-menu dropdown-menu-end">
                                <li><a class="dropdown-item" href="#"><i class="bi bi-person me-2"></i>Profile</a></li>
                                <li><a class="dropdown-item" href="#"><i class="bi bi-gear me-2"></i>Settings</a></li>
                                <li><hr class="dropdown-divider"></li>
                                <li><a class="dropdown-item" href="#" id="headerLogoutBtn"><i class="bi bi-box-arrow-right me-2"></i>Logout</a></li>
                            </ul>
                        </div>
                    </div>
                </div>

                <!-- Content Area -->
                <div id="contentArea">
                    <!-- Dashboard Content (Default) -->
                    <div id="dashboardPage" class="content-page">
                        <!-- Stats Cards -->
                        <div class="row mb-4">
                            <div class="col-md-3">
                                <div class="card stat-card">
                                    <div class="card-body">
                                        <div class="stat-icon bg-primary">
                                            <i class="bi bi-people"></i>
                                        </div>
                                        <h5 class="card-title">Total Users</h5>
                                        <h2 class="stat-value" id="totalUsers">0</h2>
                                        <p class="card-text text-muted">
                                            <i class="bi bi-arrow-up text-success me-1"></i>
                                            <span id="userGrowth">0%</span> since last month
                                        </p>
                                    </div>
                                </div>
                            </div>
                            <div class="col-md-3">
                                <div class="card stat-card">
                                    <div class="card-body">
                                        <div class="stat-icon bg-success">
                                            <i class="bi bi-trash"></i>
                                        </div>
                                        <h5 class="card-title">Smart Bins</h5>
                                        <h2 class="stat-value" id="totalBins">0</h2>
                                        <p class="card-text text-muted">
                                            <span id="activeBins">0</span> active,
                                            <span class="text-danger" id="fullBins">0</span> full
                                        </p>
                                    </div>
                                </div>
                            </div>
                            <div class="col-md-3">
                                <div class="card stat-card">
                                    <div class="card-body">
                                        <div class="stat-icon bg-info">
                                            <i class="bi bi-recycle"></i>
                                        </div>
                                        <h5 class="card-title">Total Deposits</h5>
                                        <h2 class="stat-value" id="totalDeposits">0</h2>
                                        <p class="card-text text-muted">
                                            <i class="bi bi-arrow-up text-success me-1"></i>
                                            <span id="recentDeposits">0</span> in last 7 days
                                        </p>
                                    </div>
                                </div>
                            </div>
                            <div class="col-md-3">
                                <div class="card stat-card">
                                    <div class="card-body">
                                        <div class="stat-icon bg-warning">
                                            <i class="bi bi-tree"></i>
                                        </div>
                                        <h5 class="card-title">Total Waste</h5>
                                        <h2 class="stat-value" id="totalWaste">0 kg</h2>
                                        <p class="card-text text-muted">
                                            <span id="organicWaste">0 kg</span> organic,
                                            <span id="recyclableWaste">0 kg</span> recyclable
                                        </p>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Charts -->
                        <div class="row mb-4">
                            <div class="col-md-8">
                                <div class="card">
                                    <div class="card-header">
                                        <h5 class="card-title">Deposit Activity</h5>
                                    </div>
                                    <div class="card-body">
                                        <canvas id="depositsChart" height="250"></canvas>
                                    </div>
                                </div>
                            </div>
                            <div class="col-md-4">
                                <div class="card">
                                    <div class="card-header">
                                        <h5 class="card-title">Waste Distribution</h5>
                                    </div>
                                    <div class="card-body">
                                        <canvas id="wasteDistributionChart" height="250"></canvas>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Recent Activity & Alerts -->
                        <div class="row">
                            <div class="col-md-6">
                                <div class="card">
                                    <div class="card-header">
                                        <h5 class="card-title">Recent Activity</h5>
                                    </div>
                                    <div class="card-body p-0">
                                        <div class="list-group list-group-flush" id="recentActivityList">
                                            <!-- Activity items will be populated dynamically -->
                                            <div class="list-group-item">
                                                <div class="d-flex w-100 justify-content-between">
                                                    <h6 class="mb-1">Loading recent activity...</h6>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="col-md-6">
                                <div class="card">
                                    <div class="card-header">
                                        <h5 class="card-title">Alerts</h5>
                                    </div>
                                    <div class="card-body p-0">
                                        <div class="list-group list-group-flush" id="alertsList">
                                            <!-- Alerts will be populated dynamically -->
                                            <div class="list-group-item">
                                                <div class="d-flex w-100 justify-content-between">
                                                    <h6 class="mb-1">Loading alerts...</h6>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Smart Bins Page -->
                    <div id="binsPage" class="content-page d-none">
                        <div class="d-flex justify-content-between mb-3">
                            <h3>Smart Bins Management</h3>
                            <button class="btn btn-primary" data-bs-toggle="modal" data-bs-target="#addBinModal">
                                <i class="bi bi-plus-circle me-2"></i>Add New Bin
                            </button>
                        </div>
                        
                        <!-- Bins Filter & Search -->
                        <div class="row mb-3">
                            <div class="col-md-4">
                                <div class="input-group">
                                    <span class="input-group-text"><i class="bi bi-search"></i></span>
                                    <input type="text" id="binSearchInput" class="form-control" placeholder="Search bins...">
                                </div>
                            </div>
                            <div class="col-md-2">
                                <select id="binStatusFilter" class="form-select">
                                    <option value="all">All Status</option>
                                    <option value="active">Active</option>
                                    <option value="full">Full</option>
                                    <option value="maintenance">Maintenance</option>
                                </select>
                            </div>
                            <div class="col-md-2">
                                <select id="binSortOrder" class="form-select">
                                    <option value="location">Sort by Location</option>
                                    <option value="fill_level">Sort by Fill Level</option>
                                    <option value="last_emptied">Sort by Last Emptied</option>
                                </select>
                            </div>
                            <div class="col-md-4 text-end">
                                <div class="btn-group" role="group">
                                    <button id="binListViewBtn" class="btn btn-outline-secondary active">
                                        <i class="bi bi-list-ul"></i>
                                    </button>
                                    <button id="binGridViewBtn" class="btn btn-outline-secondary">
                                        <i class="bi bi-grid-3x3-gap"></i>
                                    </button>
                                    <button id="binMapViewBtn" class="btn btn-outline-secondary">
                                        <i class="bi bi-geo-alt"></i>
                                    </button>
                                </div>
                            </div>
                        </div>
                        
                        <!-- Bins List View (Default) -->
                        <div id="binListView" class="bin-view-container">
                            <div class="card">
                                <div class="card-body p-0">
                                    <div class="table-responsive">
                                        <table class="table table-hover">
                                            <thead>
                                                <tr>
                                                    <th>Bin ID</th>
                                                    <th>Location</th>
                                                    <th>Fill Level</th>
                                                    <th>Status</th>
                                                    <th>Last Emptied</th>
                                                    <th>Actions</th>
                                                </tr>
                                            </thead>
                                            <tbody id="binsTableBody">
                                                <!-- Bins will be populated dynamically -->
                                                <tr>
                                                    <td colspan="6" class="text-center">Loading bins...</td>
                                                </tr>
                                            </tbody>
                                        </table>
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <!-- Bins Grid View -->
                        <div id="binGridView" class="bin-view-container d-none">
                            <div class="row" id="binsGridContainer">
                                <!-- Bins grid will be populated dynamically -->
                                <div class="col-12 text-center py-4">
                                    Loading bins...
                                </div>
                            </div>
                        </div>
                        
                        <!-- Bins Map View -->
                        <div id="binMapView" class="bin-view-container d-none">
                            <div class="card">
                                <div class="card-body">
                                    <div id="binsMap" style="height: 500px;">
                                        <!-- Map will be loaded here -->
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Users Page -->
                    <div id="usersPage" class="content-page d-none">
                        <h3 class="mb-3">Users Management</h3>
                        
                        <!-- Users Filter & Search -->
                        <div class="row mb-3">
                            <div class="col-md-6">
                                <div class="input-group">
                                    <span class="input-group-text"><i class="bi bi-search"></i></span>
                                    <input type="text" id="userSearchInput" class="form-control" placeholder="Search users...">
                                </div>
                            </div>
                            <div class="col-md-3">
                                <select id="userSortOrder" class="form-select">
                                    <option value="name">Sort by Name</option>
                                    <option value="points">Sort by Points</option>
                                    <option value="deposits">Sort by Deposits</option>
                                    <option value="join_date">Sort by Join Date</option>
                                </select>
                            </div>
                            <div class="col-md-3">
                                <select id="userRankFilter" class="form-select">
                                    <option value="all">All Ranks</option>
                                    <option value="Novice Recycler">Novice Recycler</option>
                                    <option value="Eco Rookie">Eco Rookie</option>
                                    <option value="Green Guardian">Green Guardian</option>
                                    <option value="Eco Warrior">Eco Warrior</option>
                                    <option value="Master Recycler">Master Recycler</option>
                                </select>
                            </div>
                        </div>
                        
                        <!-- Users List -->
                        <div class="card">
                            <div class="card-body p-0">
                                <div class="table-responsive">
                                    <table class="table table-hover">
                                        <thead>
                                            <tr>
                                                <th>User ID</th>
                                                <th>Name</th>
                                                <th>Email</th>
                                                <th>Total Points</th>
                                                <th>Rank</th>
                                                <th>Join Date</th>
                                                <th>Actions</th>
                                            </tr>
                                        </thead>
                                        <tbody id="usersTableBody">
                                            <!-- Users will be populated dynamically -->
                                            <tr>
                                                <td colspan="7" class="text-center">Loading users...</td>
                                            </tr>
                                        </tbody>
                                    </table>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Rewards Page -->
                    <div id="rewardsPage" class="content-page d-none">
                        <div class="d-flex justify-content-between mb-3">
                            <h3>Rewards Management</h3>
                            <button class="btn btn-primary" data-bs-toggle="modal" data-bs-target="#addRewardModal">
                                <i class="bi bi-plus-circle me-2"></i>Add New Reward
                            </button>
                        </div>
                        
                        <!-- Tabs -->
                        <ul class="nav nav-tabs mb-3" id="rewardsTab" role="tablist">
                            <li class="nav-item" role="presentation">
                                <button class="nav-link active" id="partner-offers-tab" data-bs-toggle="tab" data-bs-target="#partner-offers" type="button" role="tab">Partner Offers</button>
                            </li>
                            <li class="nav-item" role="presentation">
                                <button class="nav-link" id="redeemed-rewards-tab" data-bs-toggle="tab" data-bs-target="#redeemed-rewards" type="button" role="tab">Redeemed Rewards</button>
                            </li>
                        </ul>
                        
                        <!-- Tab Content -->
                        <div class="tab-content" id="rewardsTabContent">
                            <!-- Partner Offers Tab -->
                            <div class="tab-pane fade show active" id="partner-offers" role="tabpanel">
                                <!-- Partner Offers Filter -->
                                <div class="row mb-3">
                                    <div class="col-md-6">
                                        <div class="input-group">
                                            <span class="input-group-text"><i class="bi bi-search"></i></span>
                                            <input type="text" id="offerSearchInput" class="form-control" placeholder="Search offers...">
                                        </div>
                                    </div>
                                    <div class="col-md-3">
                                        <select id="offerCategoryFilter" class="form-select">
                                            <option value="all">All Categories</option>
                                            <option value="food_drinks">Food & Drinks</option>
                                            <option value="shopping">Shopping</option>
                                            <option value="entertainment">Entertainment</option>
                                        </select>
                                    </div>
                                    <div class="col-md-3">
                                        <select id="offerSortOrder" class="form-select">
                                            <option value="title">Sort by Title</option>
                                            <option value="points">Sort by Points</option>
                                            <option value="expiry">Sort by Expiry</option>
                                        </select>
                                    </div>
                                </div>
                                
                                <!-- Partner Offers List -->
                                <div class="card">
                                    <div class="card-body p-0">
                                        <div class="table-responsive">
                                            <table class="table table-hover">
                                                <thead>
                                                    <tr>
                                                        <th>Title</th>
                                                        <th>Partner</th>
                                                        <th>Category</th>
                                                        <th>Points Required</th>
                                                        <th>Start Date</th>
                                                        <th>End Date</th>
                                                        <th>Featured</th>
                                                        <th>Actions</th>
                                                    </tr>
                                                </thead>
                                                <tbody id="offersTableBody">
                                                    <!-- Offers will be populated dynamically -->
                                                    <tr>
                                                        <td colspan="8" class="text-center">Loading offers...</td>
                                                    </tr>
                                                </tbody>
                                            </table>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            
                            <!-- Redeemed Rewards Tab -->
                            <div class="tab-pane fade" id="redeemed-rewards" role="tabpanel">
                                <!-- Redeemed Rewards Filter -->
                                <div class="row mb-3">
                                    <div class="col-md-6">
                                        <div class="input-group">
                                            <span class="input-group-text"><i class="bi bi-search"></i></span>
                                            <input type="text" id="redeemedSearchInput" class="form-control" placeholder="Search redeemed rewards...">
                                        </div>
                                    </div>
                                    <div class="col-md-3">
                                        <select id="redeemedStatusFilter" class="form-select">
                                            <option value="all">All Status</option>
                                            <option value="active">Active</option>
                                            <option value="used">Used</option>
                                            <option value="expired">Expired</option>
                                        </select>
                                    </div>
                                    <div class="col-md-3">
                                        <select id="redeemedSortOrder" class="form-select">
                                            <option value="date">Sort by Date</option>
                                            <option value="user">Sort by User</option>
                                            <option value="coupon">Sort by Coupon</option>
                                        </select>
                                    </div>
                                </div>
                                
                                <!-- Redeemed Rewards List -->
                                <div class="card">
                                    <div class="card-body p-0">
                                        <div class="table-responsive">
                                            <table class="table table-hover">
                                                <thead>
                                                    <tr>
                                                        <th>User</th>
                                                        <th>Coupon Title</th>
                                                        <th>Coupon Code</th>
                                                        <th>Points Used</th>
                                                        <th>Redemption Date</th>
                                                        <th>Expiry Date</th>
                                                        <th>Status</th>
                                                        <th>Actions</th>
                                                    </tr>
                                                </thead>
                                                <tbody id="redeemedTableBody">
                                                    <!-- Redeemed rewards will be populated dynamically -->
                                                    <tr>
                                                        <td colspan="8" class="text-center">Loading redeemed rewards...</td>
                                                    </tr>
                                                </tbody>
                                            </table>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Deposits Page -->
                    <div id="depositsPage" class="content-page d-none">
                        <h3 class="mb-3">Deposits History</h3>
                        
                        <!-- Deposits Filter & Search -->
                        <div class="row mb-3">
                            <div class="col-md-4">
                                <div class="input-group">
                                    <span class="input-group-text"><i class="bi bi-search"></i></span>
                                    <input type="text" id="depositSearchInput" class="form-control" placeholder="Search deposits...">
                                </div>
                            </div>
                            <div class="col-md-2">
                                <select id="wasteTypeFilter" class="form-select">
                                    <option value="all">All Types</option>
                                    <option value="organic">Organic</option>
                                    <option value="recyclable_plastic">Plastic</option>
                                    <option value="recyclable_paper">Paper</option>
                                    <option value="recyclable_metal">Metal</option>
                                </select>
                            </div>
                            <div class="col-md-2">
                                <select id="depositDateFilter" class="form-select">
                                    <option value="all">All Time</option>
                                    <option value="today">Today</option>
                                    <option value="week">Last 7 Days</option>
                                    <option value="month">Last 30 Days</option>
                                </select>
                            </div>
                            <div class="col-md-2">
                                <select id="depositSortOrder" class="form-select">
                                    <option value="date_desc">Newest First</option>
                                    <option value="date_asc">Oldest First</option>
                                    <option value="weight_desc">Weight (High-Low)</option>
                                    <option value="weight_asc">Weight (Low-High)</option>
                                </select>
                            </div>
                            <div class="col-md-2">
                                <button id="exportDepositsBtn" class="btn btn-outline-primary w-100">
                                    <i class="bi bi-download me-2"></i>Export
                                </button>
                            </div>
                        </div>
                        
                        <!-- Deposits List -->
                        <div class="card">
                            <div class="card-body p-0">
                                <div class="table-responsive">
                                    <table class="table table-hover">
                                        <thead>
                                            <tr>
                                                <th>Deposit ID</th>
                                                <th>User</th>
                                                <th>Bin Location</th>
                                                <th>Waste Type</th>
                                                <th>Weight (kg)</th>
                                                <th>Points Earned</th>
                                                <th>Timestamp</th>
                                                <th>Actions</th>
                                            </tr>
                                        </thead>
                                        <tbody id="depositsTableBody">
                                            <!-- Deposits will be populated dynamically -->
                                            <tr>
                                                <td colspan="8" class="text-center">Loading deposits...</td>
                                            </tr>
                                        </tbody>
                                    </table>
                                </div>
                            </div>
                            <div class="card-footer">
                                <nav>
                                    <ul class="pagination justify-content-center" id="depositsPagination">
                                        <!-- Pagination will be populated dynamically -->
                                    </ul>
                                </nav>
                            </div>
                        </div>
                    </div>

                    <!-- Simulation Page -->
                    <div id="simulationPage" class="content-page d-none">
                        <h3 class="mb-3">Smart Bin Simulation</h3>
                        
                        <div class="row">
                            <div class="col-md-6">
                                <div class="card mb-4">
                                    <div class="card-header">
                                        <h5 class="card-title">Simulate Waste Deposit</h5>
                                    </div>
                                    <div class="card-body">
                                        <form id="depositSimulationForm">
                                            <div class="mb-3">
                                                <label for="simulationUser" class="form-label">User</label>
                                                <select id="simulationUser" class="form-select" required>
                                                    <option value="" disabled selected>Select User</option>
                                                    <!-- Will be populated dynamically -->
                                                </select>
                                            </div>
                                            
                                            <div class="mb-3">
                                                <label for="simulationBin" class="form-label">Smart Bin</label>
                                                <select id="simulationBin" class="form-select" required>
                                                    <option value="" disabled selected>Select Bin</option>
                                                    <!-- Will be populated dynamically -->
                                                </select>
                                            </div>
                                            
                                            <div class="mb-3">
                                                <label for="simulationWasteType" class="form-label">Waste Type</label>
                                                <select id="simulationWasteType" class="form-select" required>
                                                    <option value="" disabled selected>Select Waste Type</option>
                                                    <option value="organic">Organic</option>
                                                    <option value="recyclable_plastic">Recyclable Plastic</option>
                                                    <option value="recyclable_paper">Recyclable Paper</option>
                                                    <option value="recyclable_metal">Recyclable Metal</option>
                                                </select>
                                            </div>
                                            
                                            <div class="mb-3">
                                                <label for="simulationWeight" class="form-label">Weight (kg)</label>
                                                <input type="number" class="form-control" id="simulationWeight" min="0.1" max="10" step="0.1" value="1.0" required>
                                            </div>
                                            
                                            <button type="submit" class="btn btn-primary">
                                                <i class="bi bi-play-fill me-2"></i>Simulate Deposit
                                            </button>
                                        </form>
                                    </div>
                                </div>
                                
                                <div class="card">
                                    <div class="card-header">
                                        <h5 class="card-title">Generate QR Code</h5>
                                    </div>
                                    <div class="card-body">
                                        <form id="qrGenerationForm">
                                            <div class="mb-3">
                                                <label for="qrBin" class="form-label">Smart Bin</label>
                                                <select id="qrBin" class="form-select" required>
                                                    <option value="" disabled selected>Select Bin</option>
                                                    <!-- Will be populated dynamically -->
                                                </select>
                                            </div>
                                            
                                            <div class="mb-3">
                                                <label for="qrWasteType" class="form-label">Waste Type</label>
                                                <select id="qrWasteType" class="form-select" required>
                                                    <option value="" disabled selected>Select Waste Type</option>
                                                    <option value="organic">Organic</option>
                                                    <option value="recyclable_plastic">Recyclable Plastic</option>
                                                    <option value="recyclable_paper">Recyclable Paper</option>
                                                    <option value="recyclable_metal">Recyclable Metal</option>
                                                </select>
                                            </div>
                                            
                                            <div class="mb-3">
                                                <label for="qrWeight" class="form-label">Weight (kg)</label>
                                                <input type="number" class="form-control" id="qrWeight" min="0.1" max="10" step="0.1" value="1.0" required>
                                            </div>
                                            
                                            <button type="submit" class="btn btn-primary">
                                                <i class="bi bi-qr-code me-2"></i>Generate QR Code
                                            </button>
                                        </form>
                                    </div>
                                </div>
                            </div>
                            
                            <div class="col-md-6">
                                <div class="card">
                                    <div class="card-header">
                                        <h5 class="card-title">Simulation Results</h5>
                                    </div>
                                    <div class="card-body">
                                        <div id="simulationResults" class="d-none">
                                            <div class="alert alert-success">
                                                <h4 class="alert-heading">Simulation Successful!</h4>
                                                <p>Waste deposit has been simulated successfully.</p>
                                                <hr>
                                                <div class="row">
                                                    <div class="col-md-6">
                                                        <p class="mb-1"><strong>Deposit ID:</strong> <span id="resultDepositId"></span></p>
                                                        <p class="mb-1"><strong>User:</strong> <span id="resultUser"></span></p>
                                                        <p class="mb-1"><strong>Bin:</strong> <span id="resultBin"></span></p>
                                                        <p class="mb-1"><strong>Waste Type:</strong> <span id="resultWasteType"></span></p>
                                                    </div>
                                                    <div class="col-md-6">
                                                        <p class="mb-1"><strong>Weight:</strong> <span id="resultWeight"></span> kg</p>
                                                        <p class="mb-1"><strong>Points Earned:</strong> <span id="resultPoints"></span></p>
                                                        <p class="mb-1"><strong>Bin Fill Level:</strong> <span id="resultFillLevel"></span>%</p>
                                                        <p class="mb-1"><strong>Timestamp:</strong> <span id="resultTimestamp"></span></p>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                        
                                        <div id="qrCodeResult" class="d-none text-center">
                                            <h4 class="mb-3">Generated QR Code</h4>
                                            <div id="qrCodeDisplay" class="mb-3"></div>
                                            <p id="qrCodeData" class="mb-3 text-break"></p>
                                            <button id="downloadQrBtn" class="btn btn-primary">
                                                <i class="bi bi-download me-2"></i>Download QR Code
                                            </button>
                                        </div>
                                        
                                        <div id="noSimulationResults" class="text-center py-4">
                                            <i class="bi bi-cpu display-1 text-muted"></i>
                                            <p class="text-muted mt-3">No simulation results yet. Use the forms on the left to simulate a waste deposit or generate a QR code.</p>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Settings Page -->
                    <div id="settingsPage" class="content-page d-none">
                        <h3 class="mb-4">System Settings</h3>
                        
                        <!-- Tabs -->
                        <ul class="nav nav-tabs mb-3" id="settingsTab" role="tablist">
                            <li class="nav-item" role="presentation">
                                <button class="nav-link active" id="general-tab" data-bs-toggle="tab" data-bs-target="#general" type="button" role="tab">General</button>
                            </li>
                            <li class="nav-item" role="presentation">
                                <button class="nav-link" id="rewards-settings-tab" data-bs-toggle="tab" data-bs-target="#rewards-settings" type="button" role="tab">Rewards</button>
                            </li>
                            <li class="nav-item" role="presentation">
                                <button class="nav-link" id="notifications-tab" data-bs-toggle="tab" data-bs-target="#notifications" type="button" role="tab">Notifications</button>
                            </li>
                            <li class="nav-item" role="presentation">
                                <button class="nav-link" id="api-settings-tab" data-bs-toggle="tab" data-bs-target="#api-settings" type="button" role="tab">API Settings</button>
                            </li>
                        </ul>
                        
                        <!-- Tab Content -->
                        <div class="tab-content" id="settingsTabContent">
                            <!-- General Settings Tab -->
                            <div class="tab-pane fade show active" id="general" role="tabpanel">
                                <div class="card">
                                    <div class="card-body">
                                        <h5 class="card-title">General Settings</h5>
                                        <form id="generalSettingsForm">
                                            <div class="mb-3">
                                                <label for="appName" class="form-label">Application Name</label>
                                                <input type="text" class="form-control" id="appName" value="Smart Dustbin Ecosystem">
                                            </div>
                                            <div class="mb-3">
                                                <label for="adminEmail" class="form-label">Admin Email</label>
                                                <input type="email" class="form-control" id="adminEmail" value="admin@example.com">
                                            </div>
                                            <div class="mb-3">
                                                <label for="timezone" class="form-label">Timezone</label>
                                                <select class="form-select" id="timezone">
                                                    <option value="UTC">UTC</option>
                                                    <option value="Asia/Kolkata" selected>Asia/Kolkata (IST)</option>
                                                    <!-- Other timezones -->
                                                </select>
                                            </div>
                                            <div class="mb-3">
                                                <label for="dateFormat" class="form-label">Date Format</label>
                                                <select class="form-select" id="dateFormat">
                                                    <option value="YYYY-MM-DD">YYYY-MM-DD</option>
                                                    <option value="DD-MM-YYYY" selected>DD-MM-YYYY</option>
                                                    <option value="MM-DD-YYYY">MM-DD-YYYY</option>
                                                </select>
                                            </div>
                                            <button type="submit" class="btn btn-primary">Save Settings</button>
                                        </form>
                                    </div>
                                </div>
                            </div>
                            
                            <!-- Rewards Settings Tab -->
                            <div class="tab-pane fade" id="rewards-settings" role="tabpanel">
                                <div class="card">
                                    <div class="card-body">
                                        <h5 class="card-title">Rewards Settings</h5>
                                        <form id="rewardsSettingsForm">
                                            <div class="mb-3">
                                                <label class="form-label">Points Calculation</label>
                                                <div class="input-group mb-2">
                                                    <span class="input-group-text">Organic Waste</span>
                                                    <input type="number" class="form-control" id="organicPoints" value="5" min="1">
                                                    <span class="input-group-text">points per kg</span>
                                                </div>
                                                <div class="input-group mb-2">
                                                    <span class="input-group-text">Recyclable Plastic</span>
                                                    <input type="number" class="form-control" id="plasticPoints" value="10" min="1">
                                                    <span class="input-group-text">points per kg</span>
                                                </div>
                                                <div class="input-group mb-2">
                                                    <span class="input-group-text">Recyclable Paper</span>
                                                    <input type="number" class="form-control" id="paperPoints" value="8" min="1">
                                                    <span class="input-group-text">points per kg</span>
                                                </div>
                                                <div class="input-group mb-2">
                                                    <span class="input-group-text">Recyclable Metal</span>
                                                    <input type="number" class="form-control" id="metalPoints" value="15" min="1">
                                                    <span class="input-group-text">points per kg</span>
                                                </div>
                                            </div>
                                            <div class="mb-3">
                                                <label for="pointsPerLevel" class="form-label">Points Required Per Level</label>
                                                <input type="number" class="form-control" id="pointsPerLevel" value="100" min="1">
                                            </div>
                                            <div class="mb-3">
                                                <label for="couponExpiry" class="form-label">Default Coupon Expiry (days)</label>
                                                <input type="number" class="form-control" id="couponExpiry" value="30" min="1">
                                            </div>
                                            <button type="submit" class="btn btn-primary">Save Settings</button>
                                        </form>
                                    </div>
                                </div>
                            </div>
                            
                            <!-- Notifications Settings Tab -->
                            <div class="tab-pane fade" id="notifications" role="tabpanel">
                                <div class="card">
                                    <div class="card-body">
                                        <h5 class="card-title">Notification Settings</h5>
                                        <form id="notificationSettingsForm">
                                            <div class="mb-3">
                                                <label class="form-label">Email Notifications</label>
                                                <div class="form-check form-switch mb-2">
                                                    <input class="form-check-input" type="checkbox" id="newUserNotification" checked>
                                                    <label class="form-check-label" for="newUserNotification">New User Registration</label>
                                                </div>
                                                <div class="form-check form-switch mb-2">
                                                    <input class="form-check-input" type="checkbox" id="binFullNotification" checked>
                                                    <label class="form-check-label" for="binFullNotification">Bin Full Alert</label>
                                                </div>
                                                <div class="form-check form-switch mb-2">
                                                    <input class="form-check-input" type="checkbox" id="rewardRedeemedNotification" checked>
                                                    <label class="form-check-label" for="rewardRedeemedNotification">Reward Redemption</label>
                                                </div>
                                            </div>
                                            <div class="mb-3">
                                                <label for="binFillThreshold" class="form-label">Bin Fill Alert Threshold (%)</label>
                                                <input type="number" class="form-control" id="binFillThreshold" value="90" min="1" max="100">
                                            </div>
                                            <div class="mb-3">
                                                <label for="notificationEmail" class="form-label">Notification Email</label>
                                                <input type="email" class="form-control" id="notificationEmail" value="notifications@example.com">
                                            </div>
                                            <button type="submit" class="btn btn-primary">Save Settings</button>
                                        </form>
                                    </div>
                                </div>
                            </div>
                            
                            <!-- API Settings Tab -->
                            <div class="tab-pane fade" id="api-settings" role="tabpanel">
                                <div class="card">
                                    <div class="card-body">
                                        <h5 class="card-title">API Settings</h5>
                                        <form id="apiSettingsForm">
                                            <div class="mb-3">
                                                <label for="apiKey" class="form-label">API Key</label>
                                                <div class="input-group">
                                                    <input type="text" class="form-control" id="apiKey" value="sk_test_1234567890abcdef" readonly>
                                                    <button class="btn btn-outline-secondary" type="button" id="regenerateApiKey">
                                                        <i class="bi bi-arrow-repeat"></i>
                                                    </button>
                                                    <button class="btn btn-outline-secondary" type="button" id="copyApiKey">
                                                        <i class="bi bi-clipboard"></i>
                                                    </button>
                                                </div>
                                            </div>
                                            <div class="mb-3">
                                                <label for="apiRequestLimit" class="form-label">API Request Limit (per minute)</label>
                                                <input type="number" class="form-control" id="apiRequestLimit" value="100" min="1">
                                            </div>
                                            <div class="mb-3">
                                                <label class="form-label">Allowed Endpoints</label>
                                                <div class="form-check form-switch mb-2">
                                                    <input class="form-check-input" type="checkbox" id="allowBinsEndpoint" checked>
                                                    <label class="form-check-label" for="allowBinsEndpoint">/api/bins</label>
                                                </div>
                                                <div class="form-check form-switch mb-2">
                                                    <input class="form-check-input" type="checkbox" id="allowDepositsEndpoint" checked>
                                                    <label class="form-check-label" for="allowDepositsEndpoint">/api/simulate/deposit</label>
                                                </div>
                                                <div class="form-check form-switch mb-2">
                                                    <input class="form-check-input" type="checkbox" id="allowEmptyBinEndpoint" checked>
                                                    <label class="form-check-label" for="allowEmptyBinEndpoint">/api/simulate/empty-bin</label>
                                                </div>
                                                <div class="form-check form-switch mb-2">
                                                    <input class="form-check-input" type="checkbox" id="allowQrDataEndpoint" checked>
                                                    <label class="form-check-label" for="allowQrDataEndpoint">/api/bins/:id/qr-data</label>
                                                </div>
                                            </div>
                                            <button type="submit" class="btn btn-primary">Save Settings</button>
                                        </form>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </main>
        </div>
    </div>

    <!-- Modals -->
    <!-- Add Bin Modal -->
    <div class="modal fade" id="addBinModal" tabindex="-1" aria-labelledby="addBinModalLabel" aria-hidden="true">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="addBinModalLabel">Add New Smart Bin</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <form id="addBinForm">
                        <div class="mb-3">
                            <label for="binLocation" class="form-label">Location</label>
                            <input type="text" class="form-control" id="binLocation" required>
                        </div>
                        <div class="row mb-3">
                            <div class="col-md-6">
                                <label for="binLatitude" class="form-label">Latitude</label>
                                <input type="number" class="form-control" id="binLatitude" step="0.000001">
                            </div>
                            <div class="col-md-6">
                                <label for="binLongitude" class="form-label">Longitude</label>
                                <input type="number" class="form-control" id="binLongitude" step="0.000001">
                            </div>
                        </div>
                        <div class="mb-3">
                            <label for="binStatus" class="form-label">Status</label>
                            <select class="form-select" id="binStatus" required>
                                <option value="active" selected>Active</option>
                                <option value="maintenance">Maintenance</option>
                                <option value="inactive">Inactive</option>
                            </select>
                        </div>
                    </form>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
                    <button type="button" class="btn btn-primary" id="saveBinBtn">Add Bin</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Add Reward Modal -->
    <div class="modal fade" id="addRewardModal" tabindex="-1" aria-labelledby="addRewardModalLabel" aria-hidden="true">
        <div class="modal-dialog modal-lg">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="addRewardModalLabel">Add New Reward</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <form id="addRewardForm">
                        <div class="row mb-3">
                            <div class="col-md-8">
                                <label for="rewardTitle" class="form-label">Title</label>
                                <input type="text" class="form-control" id="rewardTitle" required>
                            </div>
                            <div class="col-md-4">
                                <label for="rewardPoints" class="form-label">Points Required</label>
                                <input type="number" class="form-control" id="rewardPoints" min="1" required>
                            </div>
                        </div>
                        <div class="row mb-3">
                            <div class="col-md-6">
                                <label for="rewardPartner" class="form-label">Partner Name</label>
                                <input type="text" class="form-control" id="rewardPartner" required>
                            </div>
                            <div class="col-md-6">
                                <label for="rewardCategory" class="form-label">Category</label>
                                <select class="form-select" id="rewardCategory" required>
                                    <option value="" disabled selected>Select Category</option>
                                    <option value="food_drinks">Food & Drinks</option>
                                    <option value="shopping">Shopping</option>
                                    <option value="entertainment">Entertainment</option>
                                </select>
                            </div>
                        </div>
                        <div class="mb-3">
                            <label for="rewardDescription" class="form-label">Description</label>
                            <textarea class="form-control" id="rewardDescription" rows="3" required></textarea>
                        </div>
                        <div class="row mb-3">
                            <div class="col-md-6">
                                <label for="rewardImageUrl" class="form-label">Image URL</label>
                                <input type="url" class="form-control" id="rewardImageUrl">
                            </div>
                            <div class="col-md-6">
                                <label for="rewardLogoUrl" class="form-label">Partner Logo URL</label>
                                <input type="url" class="form-control" id="rewardLogoUrl">
                            </div>
                        </div>
                        <div class="mb-3">
                            <label for="rewardTerms" class="form-label">Terms & Conditions</label>
                            <textarea class="form-control" id="rewardTerms" rows="3"></textarea>
                        </div>
                        <div class="mb-3">
                            <label for="rewardRedeem" class="form-label">How to Redeem</label>
                            <textarea class="form-control" id="rewardRedeem" rows="2"></textarea>
                        </div>
                        <div class="row mb-3">
                            <div class="col-md-5">
                                <label for="rewardStartDate" class="form-label">Start Date</label>
                                <input type="date" class="form-control" id="rewardStartDate" required>
                            </div>
                            <div class="col-md-5">
                                <label for="rewardEndDate" class="form-label">End Date</label>
                                <input type="date" class="form-control" id="rewardEndDate" required>
                            </div>
                            <div class="col-md-2">
                                <div class="form-check mt-4">
                                    <input class="form-check-input" type="checkbox" id="rewardFeatured">
                                    <label class="form-check-label" for="rewardFeatured">
                                        Featured
                                    </label>
                                </div>
                            </div>
                        </div>
                    </form>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
                    <button type="button" class="btn btn-primary" id="saveRewardBtn">Add Reward</button>
                </div>
            </div>
        </div>
    </div>

    <!-- View User Modal -->
    <div class="modal fade" id="viewUserModal" tabindex="-1" aria-labelledby="viewUserModalLabel" aria-hidden="true">
        <div class="modal-dialog modal-lg">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="viewUserModalLabel">User Details</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <div class="row">
                        <div class="col-md-4 text-center">
                            <img src="img/default-profile.png" alt="User Profile" class="img-thumbnail rounded-circle mb-3" width="150">
                            <h5 id="userDetailName">Loading...</h5>
                            <p id="userDetailRank" class="badge bg-primary">Novice Recycler</p>
                        </div>
                        <div class="col-md-8">
                            <div class="mb-3">
                                <label class="form-label">User ID</label>
                                <input type="text" class="form-control" id="userDetailId" readonly>
                            </div>
                            <div class="mb-3">
                                <label class="form-label">Email</label>
                                <input type="email" class="form-control" id="userDetailEmail" readonly>
                            </div>
                            <div class="row mb-3">
                                <div class="col-md-6">
                                    <label class="form-label">Total Points</label>
                                    <input type="text" class="form-control" id="userDetailPoints" readonly>
                                </div>
                                <div class="col-md-6">
                                    <label class="form-label">Level</label>
                                    <input type="text" class="form-control" id="userDetailLevel" readonly>
                                </div>
                            </div>
                            <div class="mb-3">
                                <label class="form-label">Join Date</label>
                                <input type="text" class="form-control" id="userDetailJoinDate" readonly>
                            </div>
                        </div>
                    </div>
                    
                    <!-- User Stats -->
                    <hr>
                    <h5>User Statistics</h5>
                    <div class="row mb-3">
                        <div class="col-md-3">
                            <div class="card bg-light">
                                <div class="card-body text-center">
                                    <h3 id="userDetailDeposits">0</h3>
                                    <p class="mb-0">Total Deposits</p>
                                </div>
                            </div>
                        </div>
                        <div class="col-md-3">
                            <div class="card bg-light">
                                <div class="card-body text-center">
                                    <h3 id="userDetailOrganic">0 kg</h3>
                                    <p class="mb-0">Organic Waste</p>
                                </div>
                            </div>
                        </div>
                        <div class="col-md-3">
                            <div class="card bg-light">
                                <div class="card-body text-center">
                                    <h3 id="userDetailRecyclable">0 kg</h3>
                                    <p class="mb-0">Recyclable Waste</p>
                                </div>
                            </div>
                        </div>
                        <div class="col-md-3">
                            <div class="card bg-light">
                                <div class="card-body text-center">
                                    <h3 id="userDetailRewards">0</h3>
                                    <p class="mb-0">Redeemed Rewards</p>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- User Recent Activity -->
                    <h5>Recent Activity</h5>
                    <div class="table-responsive">
                        <table class="table table-sm">
                            <thead>
                                <tr>
                                    <th>Date</th>
                                    <th>Activity</th>
                                    <th>Details</th>
                                </tr>
                            </thead>
                            <tbody id="userActivityTable">
                                <tr>
                                    <td colspan="3" class="text-center">Loading activity...</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Scripts -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/js/bootstrap.bundle.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://unpkg.com/leaflet@1.9.3/dist/leaflet.js"></script>
    <script src="https://unpkg.com/qrcode@1.5.1/build/qrcode.min.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.15.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.15.0/firebase-auth-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.15.0/firebase-firestore-compat.js"></script>
    <script src="js/firebase-config.js"></script>
    <script src="js/charts.js"></script>
    <script src="js/main.js"></script>
</body>
</html>